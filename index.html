<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <title>Овсянка, сэр!</title>
  <link href="css/styles.css" type="text/css" rel="stylesheet">
  <link rel="icon" href="img/black_oatmeal.png">
</head>
<body>
  <header>
    <h1>Овсянка Баскервилей <img class="oatmeal" src="img/white_oatmeal.png" alt="white oatmeal"></h1>
    <hr>
  </header>
  <div class="content">
    <div id="joke-div">
      <p class="stars">***</p>
      <p id="joke"></p>
      <p class="stars">***</p>
      <form action="#joke-div">
        <button id="new-joke" type="submit">Добавки!</button>      
      </form>
    </div>
  </div>
    <footer>
      <hr id="footer-hr">
      <p id="signature">Автор: <a href="https://github.com/appledix" target="_blank">Appledix</a> <img src="img/github_logo.png" alt="github"></p>
      <div>Icons made by <a href="http://www.flaticon.com/authors/nikita-golubev" title="Nikita Golubev" target="_blank">Nikita Golubev</a> and <a href="http://www.flaticon.com/authors/iconnice" title="Iconnice" target="_blank">Iconnice</a> from <a href="http://www.flaticon.com" title="Flaticon" target="_blank">www.flaticon.com</a> is licensed by <a href="http://creativecommons.org/licenses/by/3.0/" title="Creative Commons BY 3.0" target="_blank">CC 3.0 BY</a></div>
    </footer>
    <script src="js/jquery-3.1.1.js"></script>
    <script>
      function shuffle(inputArray) {
        var shuffledArray = Array.from(inputArray);
        var tmp, current, top = shuffledArray.length;
        if(top) while(--top) {
            current = ~~(Math.random() * (top + 1));
            tmp = shuffledArray[current];
            shuffledArray[current] = shuffledArray[top];
            shuffledArray[top] = tmp;
        }
        return shuffledArray;
      }
      function printJoke(joke) {
        $('#joke').html(joke);
      };
      $(document).ready(function() {
        $.getJSON('jokes.json', function(json) {
          var jokesCollection = json['jokes'];
          var jokesForPrinting = shuffle(Array.from(jokesCollection));
          printJoke(jokesForPrinting.pop()['joke']);
          $('#new-joke').on('click', function() {
            if (jokesForPrinting.length == 0) {
              jokesForPrinting = shuffle(Array.from(jokesCollection));
            }
            printJoke(jokesForPrinting.pop()['joke']);
          });
        }); 
      });
    </script>
</body>
</html>
